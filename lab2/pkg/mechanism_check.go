package pkg

import (
	"encoding/hex"
	"lab2/gost341112"
	"log"
	"os"
)

var sum512 = "1b54d01a4af5b9d5cc3d86d68d285462b19abc2475222f35c085122be4ba1ffa00ad30f8767b3a82384c6574f024c311e2a481332b08ef7f41797891c1646f48"
var sum256 = "9d151eefd8590b89daa6ba6cb74af9275dd051026bb149a452fd84e5e57b5500"

func MechanismCheck() {
	message := []byte{0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39,
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39,
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39,
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39,
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39,
		0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39,
		0x30, 0x31, 0x32}

	hash256 := gost341112.Sum256(message)
	result256 := hex.EncodeToString(hash256[:])
	hash512 := gost341112.Sum512(message)
	result512 := hex.EncodeToString(hash512[:])
	if (result512 == sum512) && (result256 == sum256) {
		log.Println("Механизм контроля работоспособности криптографических алгоритмов пройден!")
	} else {
		log.Println("Механизм контроля работоспособности криптографических алгоритмов НЕ пройден!")
		os.Exit(2)
	}
}
